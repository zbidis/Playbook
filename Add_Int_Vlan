---
- name: Create VLAN and Interface
  hosts: switches
  gather_facts: no
  vars_prompt:
    - name: vlan_id
      prompt: "Enter VLAN ID"
      private: no
    - name: vlan_ip
      prompt: "Enter IP address for VLAN interface"
      private: no
  vars:
    username: admin
    password: password
    enable_password: enable_password
  tasks:
    - name: Create VLAN
      ios_vlan:
        vlan_id: "{{ vlan_id }}"
        name: "VLAN{{ vlan_id }}"
        state: present
        provider:
          host: "{{ inventory_hostname }}"
          username: "{{ username }}"
          password: "{{ password }}"
          authorize: yes
          auth_pass: "{{ enable_password }}"
          platform: cisco_ios
    - name: Create VLAN interface
      ios_interface:
        name: "Vlan{{ vlan_id }}"
        description: "Interface for VLAN {{ vlan_id }}"
        ip_address: "{{ vlan_ip }}/24"
        state: present
        provider:
          host: "{{ inventory_hostname }}"
          username: "{{ username }}"
          password: "{{ password }}"
          authorize: yes
          auth_pass: "{{ enable_password }}"
          platform: cisco_ios
        with_items:
          - "{{ vlan_id }}"
